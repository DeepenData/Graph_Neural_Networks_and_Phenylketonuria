---
title: "R Notebook"
output: html_notebook
---

```{r}
library(arrow)
library(tidyverse)
library(ComplexHeatmap) 
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")



data_sample <- function(data, n_rows, n_cols){
                                              return(
                                                sample_n(data, n_rows)[, c(
                                                  sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
                                                  )]
                                              )
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)

ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
```


```{r}

```


```{r}

```


```{r}

```







```{r}
library(ComplexHeatmap) 



ht <- Heatmap(data %>% as.matrix(), row_km = 2)
ggsave(file.path(getwd(),'./results/figures/Heatmap_conected_Recon.png'), 
                  ggplotify::as.ggplot(ht), dpi = 90, width = 3, height = 19 )

```


```{r}
draw(ht)
```

