ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, col_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 3, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
data_subset <- filtered_graph_weights %>% data_sample(500,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
data_subset <- filtered_graph_weights %>% data_sample(900,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
data_subset <- filtered_graph_weights %>% data_sample(700,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(700,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
data_subset <- filtered_graph_weights %>% data_sample(500,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
data_subset <- filtered_graph_weights %>% data_sample(600,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(600,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(550,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,500)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(600,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,700)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(scales)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv")
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv")
df
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
df
data_numeric  <- df %>% select_if(is.numeric)
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1"))
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1"))
data_numeric  <- df %>% select_if(is.numeric)
labels
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric)
labels
data_numeric
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- data_numeric %>% data_sample(500,600)
data <- data_numeric %>% data_sample(500,600)
right_annotation = rowAnnotation(Phenotype = labels)
data <- data_numeric %>% data_sample(500,600)
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
data_numeric
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_numeric
data <- data_numeric %>% data_sample(500,600)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t %>% as_tibble()
#data <- data_numeric %>% data_sample(500,600)
data_numeric
data <- data_numeric %>% data_sample(500,600)
data_numeric  <- df %>% select_if(is.numeric) %>% t #%>% as_tibble()
data_numeric
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t #%>% as_tibble()
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t %>% as_tibble()
names(data_numeric) <- 1:ncol(data_numeric)
names(data_numeric) <- 1:ncol(data_numeric)
data_numeric
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data <- data_numeric %>% data_sample(500,600)
names(data_numeric) <- 1:ncol(data_numeric)
data_numeric["Label"] <- labels
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data <- data_numeric %>% data_sample(500,600)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t %>% as_tibble()
names(data_numeric) <- 1:ncol(data_numeric)
data_numeric["Label"] <- labels
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data <- data_numeric %>% data_sample(500,600)
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
data_subset <- data_numeric %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
data_subset <- data_numeric %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
data
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2,  show_column_names = F, show_row_names = F)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(filtered_graph_weights) , n_cols), which(names(filtered_graph_weights) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
data
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(data) , n_cols), which(names(data) == "Label")
)]
)
}
data_subset <- data_numeric %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
data
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
filtered_graph_weights <- read_parquet("./results/data/filtered_graph_weights.parquet.gzip")
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(data) , n_cols), which(names(data) == "Label")
)]
)
}
data_subset <- filtered_graph_weights %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
data
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2, right_annotation = right_annotation, show_column_names = F, show_row_names = F)
draw(ht)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/results_for_R.csv") %>% select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>% select(-c("...1")) %>% .[[1]]
data_numeric  <- df %>% select_if(is.numeric) %>% t %>% as_tibble()
names(data_numeric) <- 1:ncol(data_numeric)
data_numeric["Label"] <- labels
data_sample <- function(data, n_rows, n_cols){
return(
sample_n(data, n_rows)[, c(
sample(1:ncol(data) , n_cols), which(names(data) == "Label")
)]
)
}
data_subset <- data_numeric %>% data_sample(500,600)
labels      <- data_subset$Label
data        <- data_subset %>% select(-c("Label"))%>% tidyr::as_tibble()
right_annotation = rowAnnotation(Phenotype = labels)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2,  show_column_names = F, show_row_names = F)
draw(ht)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2,  show_column_names = F, show_row_names = F)
draw(ht)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2,  show_column_names = F, show_row_names = F, right_annotation= right_annotation)
draw(ht)
ht <- Heatmap(data %>% as.matrix() %>% scale %>% rescale, row_km = 2, column_km = 2,  show_column_names = F, show_row_names = F, right_annotation= right_annotation)
draw(ht)
