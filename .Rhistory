get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, legend = right)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, legend = 'top')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
library(EnhancedVolcano)
library(magrittr)
get_processed_results <- function(annotated_results, subset){
annotated_results %>% dplyr::filter(entrezgene_id %in% subset) %>% dplyr::select(-c(mouse_ensembl_transcript_id,hsapiens_ensembl,entrezgene_id, description)) %>%
group_by(hgnc_symbol) %>% summarise_all(median,  na.rm = TRUE) ->processed_results
return(processed_results)
}
make_volcano <- function(df_res,labSize, subtitle, pValue_cutoff     = 0.05, FoldChnage_cutoff = .1){plot <- EnhancedVolcano(
df_res,
x = 'log2FoldChange',
y = 'padj',
title = NULL,
subtitle = subtitle,#paste0( names( conjuntos )[[i]], " - ", length( unique(conjuntos[[i]][ conjuntos[[i]] %in% df_res$gene_symbol_sig ]) ), " trancripts" ),
pCutoff = pValue_cutoff,
FCcutoff = FoldChnage_cutoff,
pointSize = 3,
lab = df_res$hgnc_symbol,
#legendPosition = 'right',
labSize = labSize,
boxedLabels = T,
drawConnectors = TRUE,
widthConnectors = 0.2,
colConnectors = 'black',
max.overlaps = 200, #Inf,
)+ ggthemes::theme_few() #+
# coord_flip() +
#theme(legend.position="bottom")
return(plot)}
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, legend = 'top')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, legend = 'none')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = 'none')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = 'TOP')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = 'top')
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top'){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01)
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1))
C_volcano
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top'){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01, common.legend.pos = 'none')
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1), common.legend.pos = 'none')
CF_volcano
F_volcano
C_volcano
Concentration_rxns_and_transps %>% get_two_Entrez_gene_lists %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> C_enrichPathway
ggarrange(C_enrichPathway, C_volcano, nrow = 1) -> upper_panel
Flux_rxns_and_transps %>% get_two_Entrez_gene_lists %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> F_enrichPathway
ggarrange(F_enrichPathway, F_volcano, nrow = 1, widths = c(1,1.2)) -> middle_panel
FluxConcentration_rxns_and_transps %>% get_two_Entrez_gene_lists %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> FC_enrichPathway
ggarrange(FC_enrichPathway, CF_volcano, nrow = 1, widths = c(1,1.2)) -> lower_panel
ggarrange(upper_panel, middle_panel, lower_panel, ncol = 1,  heights = c(1,1.15,1.1))
F_volcano
ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T)
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T)
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(1.2,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(1,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(1,1.1,1.1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T)
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1.2,1,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1.2,1,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1.2,1,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1.2,1,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top'){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 1.5,2, pValue_cutoff = 0.01, common.legend.pos = 'none')
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 1.5,1.5, c(1,1), common.legend.pos = 'none')
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
Concentration_rxns_and_transps %>% get_two_Entrez_gene_lists %>% purrr::set_names(c("Reactions","Transporters")) %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> C_enrichPathway
#ggarrange(C_enrichPathway, C_volcano, nrow = 1) -> upper_panel
Flux_rxns_and_transps %>% get_two_Entrez_gene_lists %>% purrr::set_names(c("Reactions","Transporters")) %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> F_enrichPathway
#ggarrange(F_enrichPathway, F_volcano, nrow = 1, widths = c(1,1.2)) -> middle_panel
FluxConcentration_rxns_and_transps %>% get_two_Entrez_gene_lists %>% purrr::set_names(c("Reactions","Transporters")) %>%
compareCluster(fun='enrichPathway', pvalueCutoff=1e-3, qvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 7, label_format =90)+
theme(
legend.text=element_text(size=6),
legend.position = "bottom",
#legend.box = "vertical",
text = element_text(size=6)) -> FC_enrichPathway
#ggarrange(FC_enrichPathway, CF_volcano, nrow = 1, widths = c(1,1.2)) -> lower_panel
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top'){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, pValue_cutoff = 0.01, common.legend.pos = 'none')
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, c(1,1), common.legend.pos = 'none')
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.3))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.4))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.7))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.8,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.6,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(1,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.6,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8))
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1,1), labels = c())
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8)) -> full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 12, bg="white", dpi = 300)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 14, bg="white", dpi = 300)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 13, bg="white", dpi = 300)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 13.5, bg="white", dpi = 300)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 13.5, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1,1), labels = c("a","c","e"))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8)) -> full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 13.5, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1,1), labels = c("a","c","e"))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.8,1.3,1), labels = c("b","d","f"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.8)) -> full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 10, width = 13.5, bg="white", dpi = 400)
Concentration_rxns_and_transps
Concentration_rxns_and_transps
get_processed_results(annotated_results, Concentration_rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
Flux_rxns
Flux_rxns
rxns_and_transps <- Concentration_rxns_and_transps
gene_set         <- 'rxns'
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[[gene_set]]) -> DEG_table
#get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
get_DEG_table <- function(rxns_and_transps, gene_set){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[[gene_set]]) -> DEG_table
return(DEG_table)
}
get_DEG_table(Concentration_rxns_and_transps, "rxns")
#get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
get_DEG_table(Concentration_rxns_and_transps, "trns")
get_DEG_table(Flux_rxns_and_transps, "rxns")  %>% filter(padj < .01)
get_DEG_table(FluxConcentration_rxns_and_transps, "trns") %>% filter(padj < .05 & abs(log2FoldChange) > 0.1)
get_DEG_table(FluxConcentration_rxns_and_transps, "rxns") %>% filter(padj < .05 & abs(log2FoldChange) > 0.1)
get_DEG_table <- function(rxns_and_transps, gene_set){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[[gene_set]]) -> DEG_table
return(DEG_table)
}
get_DEG_table(Concentration_rxns_and_transps, "rxns")     %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_C
get_DEG_table(Concentration_rxns_and_transps, "trns")     %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_trns_C
get_DEG_table(Flux_rxns_and_transps, "rxns")              %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_F
get_DEG_table(Flux_rxns_and_transps, "trns")              %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_trns_F
get_DEG_table(FluxConcentration_rxns_and_transps, "rxns") %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_CF
get_DEG_table(FluxConcentration_rxns_and_transps, "trns") %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_trns_CF
#get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
DEGs_rxns_F
#get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
temp <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description','namespace_1003','name_1006', 'definition_1006'),filters ='hgnc_symbol',values =DEGs_rxns_C$hgnc_symbol, mart = Hs.ensembl)
temp %>% dplyr::filter(namespace_1003 == "biological_process") -> df
df
df %>% dplyr::select(c(hgnc_symbol, entrezgene_description, entrezgene_id, name_1006)) %>% nest_by(hgnc_symbol, entrezgene_description, entrezgene_id) %>% mutate(data =paste0( purrr::flatten_chr(data) , collapse = ', ')) %>%dplyr::rename('Biological Processes' = data) -> df_annot
df_annot
get_Biological_Processes <- function(DEGs){
temp <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description','namespace_1003','name_1006', 'definition_1006'),filters ='hgnc_symbol',values =DEGs$hgnc_symbol, mart = Hs.ensembl)
temp %>% dplyr::filter(namespace_1003 == "biological_process") -> df
df %>% dplyr::select(c(hgnc_symbol, entrezgene_description, entrezgene_id, name_1006)) %>% nest_by(hgnc_symbol, entrezgene_description, entrezgene_id) %>% mutate(data =paste0( purrr::flatten_chr(data) , collapse = ', ')) %>%dplyr::rename('Biological Processes' = data) -> df_annot
return(df_annot)
}
get_Biological_Processes(DEGs_rxns_C)
get_Biological_Processes(DEGs_trns_C)
get_Biological_Processes(DEGs_trns_CF)
get_Biological_Processes(DEGs_rxns_CF)
get_Biological_Processes(DEGs_rxns_F)
Biological_Processes <- list()
Biological_Processes[[1]] <- get_Biological_Processes(DEGs_rxns_C)
Biological_Processes[[2]] <-get_Biological_Processes(DEGs_trns_C)
Biological_Processes[[3]] <-get_Biological_Processes(DEGs_rxns_F)
Biological_Processes[[4]] <-get_Biological_Processes(DEGs_trns_F)
Biological_Processes[[5]] <-get_Biological_Processes(DEGs_rxns_CF)
Biological_Processes[[6]] <-get_Biological_Processes(DEGs_trns_CF)
get_Biological_Processes <- function(DEGs){
temp <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description','namespace_1003','name_1006', 'definition_1006'),filters ='hgnc_symbol',values =DEGs$hgnc_symbol, mart = Hs.ensembl)
temp %>% dplyr::filter(namespace_1003 == "biological_process") -> df
df %>% dplyr::select(c(hgnc_symbol, entrezgene_description, entrezgene_id, name_1006)) %>% nest_by(hgnc_symbol, entrezgene_description, entrezgene_id) %>% mutate(data =paste0( purrr::flatten_chr(data) , collapse = ', ')) %>%dplyr::rename('Biological Processes' = data) -> df_annot
return(df_annot)
}
Biological_Processes <- list()
Biological_Processes[[1]] <- get_Biological_Processes(DEGs_rxns_C)
Biological_Processes[[2]] <-get_Biological_Processes(DEGs_trns_C)
Biological_Processes[[3]] <-get_Biological_Processes(DEGs_rxns_F)
Biological_Processes[[4]] <-get_Biological_Processes(DEGs_trns_F)
Biological_Processes[[5]] <-get_Biological_Processes(DEGs_rxns_CF)
Biological_Processes[[6]] <-get_Biological_Processes(DEGs_trns_CF)
Biological_Processes
map(list(DEGs_rxns_C, DEGs_trns_C),get_Biological_Processes)
get_Biological_Processes <- function(DEGs){
temp <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description','namespace_1003','name_1006', 'definition_1006'),filters ='hgnc_symbol',values =DEGs$hgnc_symbol, mart = Hs.ensembl)
temp %>% dplyr::filter(namespace_1003 == "biological_process") -> df
df %>% dplyr::select(c(hgnc_symbol, entrezgene_description, entrezgene_id, name_1006)) %>% nest_by(hgnc_symbol, entrezgene_description, entrezgene_id) %>% mutate(data =paste0( purrr::flatten_chr(data) , collapse = ', ')) %>%dplyr::rename('Biological Processes' = data) -> df_annot
return(df_annot)
}
Biological_Processes <- map(list(DEGs_rxns_C, DEGs_trns_C, DEGs_rxns_F, DEGs_trns_F, DEGs_rxns_CF, DEGs_trns_CF),get_Biological_Processes)
Biological_Processes
ggtexttable
base_size =6
my_table  <- ggtexttable(Biological_Processes[[1]], rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
my_table
base_size =6
my_table  <- ggtexttable(Biological_Processes[[1]], rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
my_table
?V
?ggtexttable
base_size =6
my_table  <- ggtexttable(Biological_Processes[[1]], rows = NULL,just= 'center',
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
base_size =6
my_table  <- ggtexttable(Biological_Processes[[1]], rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
my_table
base_size =6
my_table  <- ggtexttable(Biological_Processes[[1]], rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
my_table
openxlsx
install.packages("openxlsx")
openxlsx
Biological_Processes[[1]]
setwd("/DeepenData/Repos/geometric_cobra")
library(openxlsx)
?write.xlsx
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx")
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data", append = T)
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data", append = T)
write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data2", append = T)
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
xlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data", append = T)
install.packages("xlsx")
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
xlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data", append = T)
addWorksheet
?addWorksheet
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "my_data", append = T)
wb <- loadWorkbook("./results/genes/DEGs_rxns_C.xlsx")
wb
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "DEGs_rxns_C", append = T)
wb <- loadWorkbook("./results/genes/DEGs_rxns_C.xlsx")
addWorksheet(wb,"DEGs_trns_C")
writeData(wb,"Sheet2",Biological_Processes[[2]])
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/DEGs_rxns_C.xlsx",  sheetName = "DEGs_rxns_C", append = T)
wb <- loadWorkbook("./results/genes/DEGs_rxns_C.xlsx")
addWorksheet(wb,"DEGs_trns_C")
writeData(wb,"DEGs_trns_C",Biological_Processes[[2]])
saveWorkbook(wb,"./results/genes/DEGs_rxns_C.xlsx",overwrite = TRUE)
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Differential_expressed_genes.xlsx",  sheetName = "reactions_from_concentration", append = T)
wb <- loadWorkbook("./results/genes/Differential_expressed_genes.xlsx")
addWorksheet(wb,"transport_from_concentration")
writeData(wb,"transport_from_concentration",Biological_Processes[[2]])
saveWorkbook(wb,"./results/genes/Differential_expressed_genes.xlsx",overwrite = TRUE)
#library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Differential_expressed_genes.xlsx",  sheetName = "reactions_from_concentration", append = T)
add_new_sheet <- function(xlsx_path, sheet_name, data_to_sheet ){
wb <- loadWorkbook(xlsx_path)
addWorksheet(wb,sheet_name)
writeData(wb,sheet_name,data_to_sheet)
saveWorkbook(wb,xlsx_path,overwrite = TRUE)}
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","transport_from_concentration",Biological_Processes[[2]])
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Differential_expressed_genes.xlsx",  sheetName = "sheet1_reactions_from_concentration", append = T)
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Differential_expressed_genes.xlsx",  sheetName = "s1_reactions_from_concentration", append = T)
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Differential_expressed_genes.xlsx",  sheetName = "s1_reactions_from_concentration", append = T)
add_new_sheet <- function(xlsx_path, sheet_name, data_to_sheet ){
wb <- loadWorkbook(xlsx_path)
addWorksheet(wb,sheet_name)
writeData(wb,sheet_name,data_to_sheet)
saveWorkbook(wb,xlsx_path,overwrite = TRUE)}
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s2_transport_from_concentration",Biological_Processes[[2]])
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s3_reactions_from_flux",Biological_Processes[[3]])
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s4_transport_from_flux",Biological_Processes[[4]])
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s5_reactions_from_conc_and_flux",Biological_Processes[[5]])
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s6_transport_from_conc_and_flux",Biological_Processes[[6]])
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
openxlsx::write.xlsx(Biological_Processes[[1]], file = "./results/genes/Supplementary_Table_1_Differential_expressed_genes.xlsx",  sheetName = "s1_reactions_from_concentration", append = T)
add_new_sheet <- function(xlsx_path, sheet_name, data_to_sheet ){
wb <- loadWorkbook(xlsx_path)
addWorksheet(wb,sheet_name)
writeData(wb,sheet_name,data_to_sheet)
saveWorkbook(wb,xlsx_path,overwrite = TRUE)}
add_new_sheet("./results/genes/Differential_expressed_genes.xlsx","s2_transport_from_concentration",Biological_Processes[[2]])
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
xlsx_path <- "./results/genes/Supplementary_Table_1_Differential_expressed_genes.xlsx"
openxlsx::write.xlsx(Biological_Processes[[1]], file = xlsx_path,  sheetName = "s1_reactions_from_concentration", append = T)
add_new_sheet <- function(xlsx_path, sheet_name, data_to_sheet ){
wb <- loadWorkbook(xlsx_path)
addWorksheet(wb,sheet_name)
writeData(wb,sheet_name,data_to_sheet)
saveWorkbook(wb,xlsx_path,overwrite = TRUE)}
add_new_sheet(xlsx_path,"s2_transport_from_concentration",Biological_Processes[[2]])
add_new_sheet(xlsx_path,"s3_reactions_from_flux",Biological_Processes[[3]])
add_new_sheet(xlsx_path,"s4_transport_from_flux",Biological_Processes[[4]])
add_new_sheet(xlsx_path,"s5_reactions_from_conc_and_flux",Biological_Processes[[5]])
add_new_sheet(xlsx_path,"s6_transport_from_conc_and_flux",Biological_Processes[[6]])
