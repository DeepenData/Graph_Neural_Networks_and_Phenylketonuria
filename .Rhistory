'PHETA1m',
'PHYCBOXL',
'PPOR',
'PTHPS',
'THBPT4ACAMDASE',
'r0402',
'r0403',
'r0545',
'r0547',
'r0673',
'RE0830C',
'RE0830N',
'RE1709C',
'RE1709N',
'RE2660C',
'RE2660N',
'PHLAC',
'GLYNATm',
'DHPR',
'GTPCI',
'r0398',
'PHETA1',
'HMR_6729',
'HMR_6747',
'HMR_6755',
'HMR_6770',
'HMR_6782',
'HMR_6790',
'HMR_6854',
'HMR_6874',
'HMR_6876',
"Group")
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 20),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 20),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 20),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 10),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
subsys<- c('DHPR2',
'PHETA1m',
'PHYCBOXL',
'PPOR',
'PTHPS',
'THBPT4ACAMDASE',
'r0403',
'r0545',
'r0547',
'RE0830C',
'RE0830N',
'RE1709C',
'RE1709N',
'RE2660C',
'RE2660N',
'PHLAC',
'GLYNATm',
'DHPR',
'GTPCI',
'r0398',
'PHETA1',
'HMR_6729',
'HMR_6755',
'HMR_6770',
'HMR_6782',
'HMR_6790',
'HMR_6854',
'HMR_6874',
'HMR_6876',
"Group")
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 10),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 10),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 10),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 8),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 7, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), 1), alpha(c("darkorange"), 1))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
colours <- c(alpha(c( "dodgerblue"), .8), alpha(c("darkorange"), .8))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
subsys<- c('DHPR2',
'PHETA1m',
'PHYCBOXL',
'PPOR',
'PTHPS',
'THBPT4ACAMDASE',
'r0403',
'r0545',
'r0547',
'RE0830C',
'RE0830N',
'RE1709C',
'RE1709N',
'RE2660C',
'RE2660N',
'PHLAC',
'DHPR',
'r0398',
'PHETA1',
'HMR_6729',
'HMR_6755',
'HMR_6770',
'HMR_6782',
'HMR_6790',
'HMR_6854',
'HMR_6874',
'HMR_6876',
"Group")
colours <- c(alpha(c( "dodgerblue"), .8), alpha(c("darkorange"), .8))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot
umap_plot_1
umap_plot_2
setwd("/DeepenData/Repos/geometric_cobra")
metabolites_outliers_imputed     <- arrow::read_parquet("./metabolites_data/metabolites_outliers_imputed.parquet.gzip")
rownames(metabolites_outliers_imputed) <- NULL
generate_right_swarms(metabolites_outliers_imputed) -> concentration_subplot
# a_subplot <-plot_split_violins(metabolites_outliers_imputed, 5 , vars_by_quntl, 'top', TRUE, .1, .6)
setwd("/DeepenData/Repos/geometric_cobra")
augmented_metabolite_data <- arrow::read_parquet("./results/dataframes/concentrations/augmented_metabolite_data_v2.parquet.gzip")
augmented_data <- augmented_metabolite_data %>%mutate(label = dplyr::if_else(label == 1, "PKU", "Control")) %>% rename(Group = label)
aug_PKUs <-augmented_data %>% dplyr::filter(Group == "PKU")
generate_right_swarms(aug_PKUs, color_1 = "darkorange", color_2 = "darkorange") -> concentration_subplot_augmented
make_umap <- function(data, legend.position){UMAPM <- umap::umap(data  %>% select_if(is.numeric) %>%
as.matrix(), n_neighbors = 20, scale = T, n_threads = 20, fast_sgd = F, metric = 'cosine', spread = 10)
p <- ggplot(as_tibble(UMAPM$layout), aes(V1, V2, colour= data[["Group"]]))
UMAP_reduction <-  p + geom_point(size= .2) + xlab('UMAP dimension 1') + ylab('UMAP dimension 2')+
scale_colour_manual(values =  c(alpha(c( "dodgerblue2"), .5), alpha(c("darkorange"), 1)))+
theme(legend.position=legend.position, text = element_text(size = 9), axis.title.y = element_text(size = 7),  axis.title.x = element_text(size = 7))   +
guides(color = guide_legend(override.aes = list(size = 3) ) )+guides(color = guide_legend(title = "Group", override.aes = list(size = 3) ))
return(UMAP_reduction)}
#metabolite_data %>% make_umap('none') -> umap_plot_1
p
setwd("/DeepenData/Repos/geometric_cobra")
metabolites_outliers_imputed     <- arrow::read_parquet("./metabolites_data/metabolites_outliers_imputed.parquet.gzip") # %>% rename( Group = label) #%>% mutate(Group = if_else(Group == 1,'PKU','Control')) #%>% make_umap('none')-> umap_plot_1
metabolites_outliers_imputed %>% make_umap('none') -> umap_plot_1
setwd("/DeepenData/Repos/geometric_cobra")
augmented_metabolite_data <- arrow::read_parquet("./results/dataframes/concentrations/augmented_metabolite_data_v2.parquet.gzip")
augmented_metabolite_data %>%
rename( Group = label) %>% mutate(Group = if_else(Group == 1,'PKU','Control')) %>% make_umap('none')-> umap_plot_2
concentration_subplot
ggarrange(umap_plot_1, umap_plot_2)
ggarrange(umap_plot_1, umap_plot_2) -> umap_panel
ggarrange(concentration_subplot_augmented, umap_panel, ncol = 1)
ggarrange(concentration_subplot, umap_panel, ncol = 1)
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.5))
ggarrange(umap_plot_1, umap_plot_2) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.5))
ggarrange(umap_plot_1, umap_plot_2) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.3))
ggarrange(umap_plot_1, umap_plot_2) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.25))
ggarrange(umap_plot_1, umap_plot_2, labels = c("f","g")) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.25))
ggarrange(umap_plot_1, umap_plot_2, labels = c("f","g"), vjust = 1.1, hjust = .5) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.25))
ggarrange(umap_plot_1, umap_plot_2, labels = c("f","g"), vjust = 1.1, hjust = .2) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.25))
ggarrange(umap_plot_1, umap_plot_2, labels = c("f","g"), vjust = 1.1, hjust = .2) -> umap_panel
ggarrange(concentration_subplot, umap_panel, ncol = 1, heights = c(1,.25)) -> left_panel
colours <- c(alpha(c( "dodgerblue"), .8), alpha(c("darkorange"), .8))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="right",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot -> flux_subplot
setwd("/DeepenData/Repos/geometric_cobra")
img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
graph <- ggplot() + background_image(img)
setwd("/DeepenData/Repos/geometric_cobra")
img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
graph <- ggplot() + background_image(img)
graph
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
graph <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
graph <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
graph
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
PKU_concentration.png
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
control_fluxes.png
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
PKU_fluxes.png
arrange(control_concentration.png, PKU_concentration.png)
ggarrange(control_concentration.png, PKU_concentration.png)
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png)
left_panel
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(flux_subplot, graphs_panel)
ggarrange(flux_subplot, graphs_panel, nrow = 2)
ggarrange(flux_subplot, graphs_panel, nrow = 2, heights = c(1,.5))
ggarrange(flux_subplot, graphs_panel, nrow = 2, heights = c(1,1.5))
ggarrange(flux_subplot, graphs_panel, nrow = 2, heights = c(1,1.7))
ggarrange(flux_subplot, graphs_panel, nrow = 2, heights = c(1,1.7)) -> right_panel
ggarrange(left_panel,right_panel, ncol = 2 )
ggarrange(left_panel,right_panel, ncol = 2 )
ggarrange(left_panel,right_panel, ncol = 2, widths = c(1,1.3) )
ggarrange(left_panel,right_panel, ncol = 2, widths = c(1,1.3) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(flux_subplot,umap_panel, graphs_panel, nrow = 3, heights = c(1,1.7)) -> right_panel
right_panel
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(1,1.7)) -> right_panel
right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(1,1,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.6,1,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.6,.5,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.5,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.3) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1.2) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1) )
colours <- c(alpha(c( "dodgerblue"), .8), alpha(c("darkorange"), .8))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="top",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot -> flux_subplot
flux_subplot
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.5,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1) )
colours <- c(alpha(c( "dodgerblue"), .8), alpha(c("darkorange"), .8))
p <- all_flux_samples %>% dplyr::select(subsys) %>% sample_n(500)  %>%
pivot_longer(-Group)  %>%
ggplot(aes(name,value,color= Group))+
geom_quasirandom(size= c(.1)) + #scale_fill_manual(values = colours, name = "") +
theme_minimal()+
guides(color = guide_legend(override.aes = list(size = 5, alpha = 1) ))+
theme(axis.title.x = element_blank(),axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),
axis.title.y = element_blank(), legend.position="none",axis.text = element_text(size = 7),
legend.text = element_text(size=7))+scale_color_discrete(name="")+
scale_colour_manual(values = colours, name = "")
foo(p)%>% as_ggplot -> flux_subplot
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.5,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,1) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1)) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h","")) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = 1) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = 2) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = -2) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = -1) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = -.1) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png, labels = c("i","","k","")) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = -.1) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) )
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) ) -> full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave('./results/figures/figure_1.png', full_panel, height = 7, width = 9)
ggsave('./results/figures/figure_1.png', full_panel, height = 7, width = 9, bg = "white")
setwd("/DeepenData/Repos/geometric_cobra")
ggsave('./results/figures/figure_1.png', full_panel, height = 7, width = 9, bg = "white")
setwd("/DeepenData/Repos/geometric_cobra")
#img <- png::readPNG("./results/graphs/for_visualizations/control_concentration.png")
control_concentration.png <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_concentration.png"))
PKU_concentration.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_concentration.png"))
control_fluxes.png     <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/control_fluxes.png"))
PKU_fluxes.png         <- ggplot() + background_image( png::readPNG("./results/graphs/for_visualizations/PKU_fluxes.png"))
ggarrange(control_concentration.png, PKU_concentration.png, control_fluxes.png, PKU_fluxes.png, labels = c("i","","j","")) ->  graphs_panel
ggarrange(umap_panel, flux_subplot,graphs_panel, nrow = 3, heights = c(.3,.4,1), labels = c("","h",""), vjust = -.1) -> right_panel
ggarrange(concentration_subplot,right_panel, ncol = 2, widths = c(1,.9) ) -> full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave('./results/figures/figure_1.png', full_panel, height = 7, width = 9, bg = "white")
