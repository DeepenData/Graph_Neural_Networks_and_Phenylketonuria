setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(1.8,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(1.8,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(1.8,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(1.9,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2.3,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(1.9,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2.5,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(1.9,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2.5,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(2.2,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 3,3, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2.7,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(2.5,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
make_volcano_panel <- function(rxns_and_transps, labSize_1 =3, labSize_2=3,  widths = c(1,.5), pValue_cutoff = 0.05, common.legend.pos = 'top', left_y_limts = c(0,10), right_y_limts = c(0,10)){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['rxns']]) -> Flux_rxns
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[['trns']]) -> Flux_trns
volcano_panel <- ggarrange(make_volcano(Flux_rxns, labSize = labSize_1, subtitle = 'Reactions', pValue_cutoff = pValue_cutoff) + ylim(left_y_limts),
make_volcano(Flux_trns, labSize = labSize_2, subtitle = 'Transporters', pValue_cutoff=pValue_cutoff) + ylim(right_y_limts), nrow = 1, widths = widths, common.legend = T, legend = common.legend.pos)
return(volcano_panel)}
C_volcano  <- make_volcano_panel(Concentration_rxns_and_transps, 2,2, c(1,1),     pValue_cutoff    = 0.05, left_y_limts = c(0,10), right_y_limts = c(0,10))
F_volcano  <- make_volcano_panel(Flux_rxns_and_transps, 2,2, widths =c(2.7,1),                      pValue_cutoff  = 0.01, common.legend.pos = 'none',left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
CF_volcano <- make_volcano_panel(FluxConcentration_rxns_and_transps, 2,2, widths =c(2.5,1),pValue_cutoff = 0.01, common.legend.pos = 'none', left_y_limts = c(0,20.42), right_y_limts = c(0,12.5))
volcanos_panel   <- ggarrange(C_volcano, F_volcano, CF_volcano, ncol = 1, common.legend = T, heights = c(.4,1,1), labels = c("b","d","f"))
volcanos_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4_volcano_panel_subplot.png", volcanos_panel, height = 10, width = 10, bg="white", dpi = 400)
enrichment_panel <-  ggarrange(C_enrichPathway, F_enrichPathway, FC_enrichPathway, ncol = 1, common.legend = T, heights = c(.7,1.1,1), labels = c("a","c","e"))
ggarrange(enrichment_panel, volcanos_panel, nrow = 1, widths = c(1,1.6)) -> full_panel
full_panel
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/Figure_4.png", full_panel, height = 13, width = 15.2, bg="white", dpi = 500)
get_DEG_table <- function(rxns_and_transps, gene_set){
get_processed_results(annotated_results, rxns_and_transps %>% get_two_Entrez_gene_lists %>% .[[gene_set]]) -> DEG_table
return(DEG_table)
}
get_DEG_table(Concentration_rxns_and_transps, "rxns")     %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_C
get_DEG_table(Concentration_rxns_and_transps, "trns")     %>% filter(padj < .05 & abs(log2FoldChange) > 0.1) -> DEGs_trns_C
get_DEG_table(Flux_rxns_and_transps, "rxns")              %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_F
get_DEG_table(Flux_rxns_and_transps, "trns")              %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_trns_F
get_DEG_table(FluxConcentration_rxns_and_transps, "rxns") %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_rxns_CF
get_DEG_table(FluxConcentration_rxns_and_transps, "trns") %>% filter(padj < .01 & abs(log2FoldChange) > 0.1) -> DEGs_trns_CF
library(ggvenn)
l <- list(
DEGs_C = c(DEGs_rxns_C$hgnc_symbol, DEGs_trns_C$hgnc_symbol),
DEGs_F =  c(DEGs_rxns_F$hgnc_symbol, DEGs_trns_F$hgnc_symbol),
DEGs_CF = c(DEGs_rxns_CF$hgnc_symbol, DEGs_trns_CF$hgnc_symbol))
ggvenn(l,  stroke_size = 0.4,  set_name_size = 2, text_size = 3.5, show_elements = F) -> supplemental_venn_diagram
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplemental_venn_diagram.png", supplemental_venn_diagram, height = 4, width = 4, bg="white", dpi = 400)
supplemental_venn_diagram
DEGs_C = c(DEGs_rxns_C$hgnc_symbol, DEGs_trns_C$hgnc_symbol)
DEGs_F =  c(DEGs_rxns_F$hgnc_symbol, DEGs_trns_F$hgnc_symbol)
DEGs_CF = c(DEGs_rxns_CF$hgnc_symbol, DEGs_trns_CF$hgnc_symbol)
all_genes <- c(DEGs_C, DEGs_F, DEGs_CF) %>% unique()
get_gene_row <- function(a_gene){
gene_row <-  c("","","")
if(a_gene %in% DEGs_C){gene_row[1] <-  "\U1F5F8"}
if(a_gene %in% DEGs_F){gene_row[2] <-  "\U1F5F8"}
if(a_gene %in% DEGs_CF){gene_row[3] <-  "\U1F5F8"}
return(gene_row)
}
#a_gene    <- 'UYURT'
my_rows <- tibble()
for (a_gene in all_genes){
a_row <- get_gene_row(a_gene)
my_rows <- rbind(my_rows, a_row)
}
names(my_rows) <- c("Conc","Flux","Conc+Flux")
my_rows["hgnc_symbol"] <- all_genes
inner_join(my_rows,
annotated_results[c("hgnc_symbol", "entrezgene_id", "description")] %>% unique
)%>% dplyr::group_by(Conc, Flux) %>% arrange(desc("Conc+Flux"), .by_group=T) ->annotated_gene_groups
first_part <- ceiling(nrow(annotated_gene_groups)/2)
annotated_gene_groups[1:first_part,]                                -> annotated_gene_groups_1
annotated_gene_groups[(first_part+1):nrow(annotated_gene_groups),]  -> annotated_gene_groups_2
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 7.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 7.7, width = 10.5, bg="white", dpi = 400)
get_Biological_Processes <- function(DEGs){
temp <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description','namespace_1003','name_1006', 'definition_1006'),filters ='hgnc_symbol',values =DEGs$hgnc_symbol, mart = Hs.ensembl)
temp %>% dplyr::filter(namespace_1003 == "biological_process") -> df
df %>% dplyr::select(c(hgnc_symbol, entrezgene_description, entrezgene_id, name_1006)) %>% nest_by(hgnc_symbol, entrezgene_description, entrezgene_id) %>% mutate(data =paste0( purrr::flatten_chr(data) , collapse = ', ')) %>%dplyr::rename('Biological Processes' = data) -> df_annot
return(df_annot)
}
Biological_Processes <- map(list(DEGs_rxns_C, DEGs_trns_C, DEGs_rxns_F, DEGs_trns_F, DEGs_rxns_CF, DEGs_trns_CF),get_Biological_Processes)
library(openxlsx)
setwd("/DeepenData/Repos/geometric_cobra")
xlsx_path <- "./results/genes/Supplementary_Table_1_Differential_expressed_genes.xlsx"
openxlsx::write.xlsx(Biological_Processes[[1]], file = xlsx_path,  sheetName = "s1_reactions_from_concentration", append = T)
add_new_sheet <- function(xlsx_path, sheet_name, data_to_sheet ){
wb <- loadWorkbook(xlsx_path)
addWorksheet(wb,sheet_name)
writeData(wb,sheet_name,data_to_sheet)
saveWorkbook(wb,xlsx_path,overwrite = TRUE)}
add_new_sheet(xlsx_path,"s2_transport_from_concentration",Biological_Processes[[2]])
add_new_sheet(xlsx_path,"s3_reactions_from_flux",Biological_Processes[[3]])
add_new_sheet(xlsx_path,"s4_transport_from_flux",Biological_Processes[[4]])
add_new_sheet(xlsx_path,"s5_reactions_from_conc_and_flux",Biological_Processes[[5]])
add_new_sheet(xlsx_path,"s6_transport_from_conc_and_flux",Biological_Processes[[6]])
DEGs_C = c(DEGs_rxns_C$hgnc_symbol, DEGs_trns_C$hgnc_symbol)
DEGs_F =  c(DEGs_rxns_F$hgnc_symbol, DEGs_trns_F$hgnc_symbol)
DEGs_CF = c(DEGs_rxns_CF$hgnc_symbol, DEGs_trns_CF$hgnc_symbol)
all_genes <- c(DEGs_C, DEGs_F, DEGs_CF) %>% unique()
get_gene_row <- function(a_gene){
gene_row <-  c("","","")
if(a_gene %in% DEGs_C){gene_row[1] <-  "\U1F5F8"}
if(a_gene %in% DEGs_F){gene_row[2] <-  "\U1F5F8"}
if(a_gene %in% DEGs_CF){gene_row[3] <-  "\U1F5F8"}
return(gene_row)
}
#a_gene    <- 'UYURT'
my_rows <- tibble()
for (a_gene in all_genes){
a_row <- get_gene_row(a_gene)
my_rows <- rbind(my_rows, a_row)
}
names(my_rows) <- c("Conc","Flux","Conc+Flux")
my_rows["hgnc_symbol"] <- all_genes
inner_join(my_rows,
annotated_results[c("hgnc_symbol", "entrezgene_id", "description")] %>% unique
)%>% dplyr::group_by(Conc, Flux) %>% arrange(desc("Conc+Flux"), .by_group=T) ->annotated_gene_groups
first_part <- ceiling(nrow(annotated_gene_groups)/2)
annotated_gene_groups[1:first_part+20,]                                -> annotated_gene_groups_1
annotated_gene_groups[(first_part+20+1):nrow(annotated_gene_groups),]  -> annotated_gene_groups_2
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 7.7, width = 10.5, bg="white", dpi = 400)
DEGs_C = c(DEGs_rxns_C$hgnc_symbol, DEGs_trns_C$hgnc_symbol)
DEGs_F =  c(DEGs_rxns_F$hgnc_symbol, DEGs_trns_F$hgnc_symbol)
DEGs_CF = c(DEGs_rxns_CF$hgnc_symbol, DEGs_trns_CF$hgnc_symbol)
all_genes <- c(DEGs_C, DEGs_F, DEGs_CF) %>% unique()
get_gene_row <- function(a_gene){
gene_row <-  c("","","")
if(a_gene %in% DEGs_C){gene_row[1] <-  "\U1F5F8"}
if(a_gene %in% DEGs_F){gene_row[2] <-  "\U1F5F8"}
if(a_gene %in% DEGs_CF){gene_row[3] <-  "\U1F5F8"}
return(gene_row)
}
#a_gene    <- 'UYURT'
my_rows <- tibble()
for (a_gene in all_genes){
a_row <- get_gene_row(a_gene)
my_rows <- rbind(my_rows, a_row)
}
names(my_rows) <- c("Conc","Flux","Conc+Flux")
my_rows["hgnc_symbol"] <- all_genes
inner_join(my_rows,
annotated_results[c("hgnc_symbol", "entrezgene_id", "description")] %>% unique
)%>% dplyr::group_by(Conc, Flux) %>% arrange(desc("Conc+Flux"), .by_group=T) ->annotated_gene_groups
first_part <- ceiling(nrow(annotated_gene_groups)/2)
annotated_gene_groups[1:(first_part+20),]                                -> annotated_gene_groups_1
annotated_gene_groups[(first_part+20+1):nrow(annotated_gene_groups),]  -> annotated_gene_groups_2
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 7.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 8.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 7.7, width = 10.5, bg="white", dpi = 400)
annotated_gene_groups_1
rownames(annotated_gene_groups_1)
rownames(annotated_gene_groups_1) <- NULL
rownames(annotated_gene_groups_1)
DEGs_C = c(DEGs_rxns_C$hgnc_symbol, DEGs_trns_C$hgnc_symbol)
DEGs_F =  c(DEGs_rxns_F$hgnc_symbol, DEGs_trns_F$hgnc_symbol)
DEGs_CF = c(DEGs_rxns_CF$hgnc_symbol, DEGs_trns_CF$hgnc_symbol)
all_genes <- c(DEGs_C, DEGs_F, DEGs_CF) %>% unique()
get_gene_row <- function(a_gene){
gene_row <-  c("","","")
if(a_gene %in% DEGs_C){gene_row[1] <-  "\U1F5F8"}
if(a_gene %in% DEGs_F){gene_row[2] <-  "\U1F5F8"}
if(a_gene %in% DEGs_CF){gene_row[3] <-  "\U1F5F8"}
return(gene_row)
}
#a_gene    <- 'UYURT'
my_rows <- tibble()
for (a_gene in all_genes){
a_row <- get_gene_row(a_gene)
my_rows <- rbind(my_rows, a_row)
}
names(my_rows) <- c("Conc","Flux","Conc+Flux")
my_rows["hgnc_symbol"] <- all_genes
inner_join(my_rows,
annotated_results[c("hgnc_symbol", "entrezgene_id", "description")] %>% unique
)%>% dplyr::group_by(Conc, Flux) %>% arrange(desc("Conc+Flux"), .by_group=T) ->annotated_gene_groups
first_part <- ceiling(nrow(annotated_gene_groups)/2)
annotated_gene_groups[1:(first_part+20),]                                -> annotated_gene_groups_1
annotated_gene_groups[(first_part+20+1):nrow(annotated_gene_groups),]  -> annotated_gene_groups_2
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03, rows = NULL) -> supplementary_gene_table_1_second
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic", rows = NULL) -> supplementary_gene_table_1_first
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 7.7, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 7.7, width = 10.5, bg="white", dpi = 200)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 10.5, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 9, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.07)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = 0)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.03)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -.3)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = -ene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = .3)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = .1)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = .11)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = .13)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "Supplementary Table 1"
annotated_gene_groups_1 %>% ggtexttable(rows = NULL,theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 10, hjust = .09)  %>%
tab_add_footnote(text = "(Continued on next page)", size = 8, face = "italic") -> supplementary_gene_table_1_first
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_first.png", supplementary_gene_table_1_first, height = 10.5, width = 8, bg="white", dpi = 400)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 7.7, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5.7, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5.7, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = -.03) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = .09) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = .08) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5, width = 7, bg="white", dpi = 200)
base_size =8
main.title <- "(Continued from previous page)"
annotated_gene_groups_2 %>% ggtexttable(rows = NULL, theme = ttheme('mBlue', base_size = base_size,  padding = unit(c(1.4, 1.4), "mm"))) %>%
tab_add_title(text = main.title, face = "bold", padding = unit(.5, "line"), size = 8, hjust = .07) -> supplementary_gene_table_1_second
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/supplementary_gene_table_1_second.png", supplementary_gene_table_1_second, height = 5, width = 7, bg="white", dpi = 200)
