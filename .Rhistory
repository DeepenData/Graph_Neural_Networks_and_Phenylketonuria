clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichDGN', pvalueCutoff=5e-4)-> enrich_output
enrich_output %>% dotplot(showCategory = 7, font.size = 7, label_format =35)
clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichDGN', pvalueCutoff=1e-3)-> enrich_output
enrich_output %>% dotplot(showCategory = 7, font.size = 7, label_format =35)
clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichDGN', pvalueCutoff=1e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 7, font.size = 7, label_format =35)
enrich_output %>% dotplot(showCategory = 5, font.size = 7, label_format =35)
enrich_output %>% dotplot(showCategory = 6, font.size = 7, label_format =35)
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
library(ggpubr)
library(ggplot2)
library(DOSE)
library(magrittr)
library(biomaRt)
library(tidyverse)
library(clusterProfiler)
library(ReactomePA)
library(org.Hs.eg.db)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/Masked_results_for_R.csv") %>% dplyr::select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>%  dplyr::select(-c("...1")) %>% .[[1]]
edge_weights_x_patients <- df%>%  dplyr::select_if(is.numeric)
edges_genes   <- df%>%  dplyr::select_if(is.character)
n_edges <- nrow(edges_genes)
n_patients <- length(labels)
#view(edges_genes)
edges_mask    <- sample(c(T,F), n_edges, replace = T, prob = c(1, 0))
patients_mask <- sample(c(T,F), n_patients, replace = T, prob = c(.3, .7))
edge_weights_x_patients_SAMPLE <- edge_weights_x_patients[edges_mask,patients_mask]
labels_SAMPLE <- labels[patients_mask]
edges_genes_SAMPLE <- edges_genes[edges_mask,]
processed_data <- edge_weights_x_patients_SAMPLE %>% as.matrix() %>% scale %>% rescale
dim(processed_data)
right_annotation = rowAnnotation(Phenotype = labels_SAMPLE)
ht <- Heatmap(t(processed_data), row_km = 2, column_km = 4,  show_column_names = F, show_row_names = F, right_annotation= right_annotation)
heatmap_clusters <- waRRior::heatmap_extract_cluster(draw(ht), t(processed_data),  which = "column")
get_entrez_IDs_cluster <- function(a_cluster) {
edges_clusters   <-  heatmap_clusters[['Cluster']]
cluster_mask     <- edges_clusters ==a_cluster
genes_list       <- edges_genes_SAMPLE$genes[cluster_mask] %>% str_extract_all('\\d+(?=\\.)')
entrez_IDs       <- genes_list%>% unlist() %>% unique()
return(entrez_IDs)}
clusters <- unique(heatmap_clusters[['Cluster']])
lapply(clusters, get_entrez_IDs_cluster) %>% purrr::set_names(clusters) -> clusters_list
clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichPathway', pvalueCutoff=1e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 5, font.size = 7, label_format =35)
clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichKEGG', pvalueCutoff=1e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 7, font.size = 7, label_format =35)
clusters_list[c("4","3","2")] %>% compareCluster(fun='enrichDGN', pvalueCutoff=1e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 6, font.size = 7, label_format =35)
#
library(arrow)
library(tidyverse)
library(ComplexHeatmap)
library(scales)
library(ggpubr)
library(ggplot2)
library(DOSE)
library(magrittr)
library(biomaRt)
library(tidyverse)
library(clusterProfiler)
library(ReactomePA)
library(org.Hs.eg.db)
library(fastcluster)
setwd("/DeepenData/Repos/geometric_cobra")
df <- read_csv("./results/data/Masked_results_for_R.csv") %>% dplyr::select(-c("...1"))
labels <- read_csv("./results/data/results_for_R_labels.csv") %>%  dplyr::select(-c("...1")) %>% .[[1]]
edge_weights_x_patients <- df%>%  dplyr::select_if(is.numeric)
edges_genes   <- df%>%  dplyr::select_if(is.character)
n_edges <- nrow(edges_genes)
n_patients <- length(labels)
view(edges_genes)
edges_mask    <- sample(c(T,F), n_edges, replace = T, prob = c(1, 0))
patients_mask <- sample(c(T,F), n_patients, replace = T, prob = c(.5, 0.5))
edge_weights_x_patients_SAMPLE <- edge_weights_x_patients[edges_mask,patients_mask]
labels_SAMPLE <- labels[patients_mask]
edges_genes_SAMPLE <- edges_genes[edges_mask,]
processed_data <- edge_weights_x_patients_SAMPLE %>% as.matrix() %>% scale %>% rescale
dim(processed_data)
rowSums(processed_data) %>% as.vector() -> edge_scores
right_annotation <- rowAnnotation(Group = labels_SAMPLE,
col = list(Group = c(
"Control"        = "green4",
"PKU"            =  "orange")))
top_annotation <- columnAnnotation(`Score` = anno_lines( pch = 26, size = unit(5, "mm"), gp = gpar(col = 'red4'),
edge_scores, height = unit(1.5, "cm")))
bottom_annotation <- HeatmapAnnotation(foo = anno_block(labels = c("C1", "C2", "C3", "C4"),labels_gp = gpar(col = "darkslategray", fontsize = 9),
gp = gpar(fill = c("azure2","azure2","azure2","azure2"))))
#densityHeatmap(t(processed_data),  ylim = c(0.02, 0.5),  ylab = "some values", show_quantiles = F, mc.cores =20, cores = 20,
#               cluster_columns = TRUE,  clustering_distance_columns  =  function(x) fastcluster::hclust(dist(x), "euclidean"))  %v%
ht <- Heatmap(t(processed_data),
clustering_distance_columns  =  function(x) fastcluster::hclust(dist(x), "euclidean"),
cluster_columns              =  function(x) fastcluster::hclust(dist(x), "complete"),
clustering_distance_rows  =  function(x) fastcluster::hclust(dist(x), "euclidean"),
cluster_rows              =  function(x) fastcluster::hclust(dist(x), "complete"),
name = "Edge weight",
border = TRUE,
row_km = 2,
column_km = 4,
row_gap = unit(2, "mm"),
column_gap = unit(2, "mm"),
width = unit(15, "cm"),
height = unit(8, "cm"),
show_column_names = F,
show_row_names = F,
column_title = c( "Edges from the metabolic network"),
column_title_gp = gpar(fontsize = 11),
row_title = c("Samples (patients)"),
row_title_gp = gpar(fontsize = 11),
row_dend_width    = unit(1.5, "cm"),
column_dend_height = unit(1.5,"cm"),
top_annotation = top_annotation,
right_annotation = right_annotation,
bottom_annotation = bottom_annotation)
heatmap_clusters <- waRRior::heatmap_extract_cluster(draw(ht), t(processed_data),  which = "column")
heatmap_clusters %>% count(Cluster, sort = TRUE) %>% .[['Cluster']] -> clusters_descending_sorted
clusters_descending_sorted[2:length(clusters_descending_sorted)] -> real_clusters
get_entrez_IDs_cluster <- function(a_cluster) {
edges_clusters   <-  heatmap_clusters[['Cluster']]
cluster_mask     <- edges_clusters ==a_cluster
genes_list       <- edges_genes_SAMPLE$genes[cluster_mask] %>% str_extract_all('\\d+(?=\\.)')
entrez_IDs       <- genes_list%>% unlist() %>% unique()
return(entrez_IDs)}
clusters <- unique(heatmap_clusters[['Cluster']])
lapply(clusters, get_entrez_IDs_cluster) %>% purrr::set_names(clusters) %>% .[real_clusters] %>% purrr::set_names(c("C4", "C2", "C1")) -> clusters_list
clusters_list %>% compareCluster(fun='enrichGO', pvalueCutoff=1e-7, OrgDb = 'org.Hs.eg.db',ont="BP", qvalueCutoff=1e-7)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 9, label_format =40) ->enrichGO
clusters_list %>% compareCluster(fun='enrichKEGG', pvalueCutoff=5e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 7, font.size = 9, label_format =40) -> enrichKEGG
clusters_list%>% compareCluster(fun='enrichDGN', pvalueCutoff=1e-2)-> enrich_output
enrich_output %>% dotplot(showCategory = 6, font.size = 9, label_format =40) -> enrichDGN
enrich_panel<-  ggarrange(enrichGO,enrichKEGG, enrichDGN, common.legend = T, legend = "right", ncol=3, labels = c("b","c","d") )
enrich_panel
enrich_panel<-  ggarrange(enrichGO,enrichKEGG, enrichDGN, common.legend = T, legend = "right", ncol=3, labels = c("b","c","d") )
heatmap_ggploted <- ggplotify::as.ggplot(ht)
ensembl    <- useMart("ensembl")
Hs.ensembl <- useMart("ensembl",dataset="hsapiens_gene_ensembl")
ensembl    <- useMart("ensembl")
Hs.ensembl <- useMart("ensembl",dataset="hsapiens_gene_ensembl")
genes_symbols <- list()
idx           <- 0
entrez_IDs <- clusters_list %>% unlist() %>% as.vector() %>% unique()
temp         <- getBM(attributes=c('hgnc_symbol',"entrezgene_id", 'entrezgene_description'),filters ='entrezgene_id',values = entrez_IDs, mart = Hs.ensembl)
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.4), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.9) , ncol = 1)
panel_MASKED
enrich_panel<-  ggarrange(enrichGO,enrichKEGG, enrichDGN, common.legend = T, legend = "right", ncol=3, labels = c("b","c","d") )
enrich_panel
enrich_panel<-  ggarrange(enrichGO,enrichKEGG, enrichDGN, common.legend = T, legend = "right", ncol=3, labels = c("b","c","d") )
enrich_panel
clusters_list %>% compareCluster(fun='enrichGO', pvalueCutoff=1e-7, OrgDb = 'org.Hs.eg.db',ont="BP", qvalueCutoff=1e-7)-> enrich_output
enrich_output %>% dotplot(showCategory = 10, font.size = 9, label_format =40) ->enrichGO
enrich_panel<-  ggarrange(enrichGO,enrichKEGG, enrichDGN, common.legend = T, legend = "right", ncol=3, labels = c("b","c","d") )
enrich_panel
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.9) , ncol = 1)
panel_MASKED
base_size =3
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.4), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.4), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.6), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("#e8f3de", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("orange3", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("orange", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("orange", "orange2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("orange", "orange2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("orange", "orange2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("coral", "orange2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "orange3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("aquamarine", "orange2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size)
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme("mOrange",
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size)
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("cornsilk", "#d3e8bb"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("cornsilk", "cornsilk1"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "#8cc257", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("cornsilk", "cornsilk2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "cornsilk3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("cornsilk", "cornsilk2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "cornsilk4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("cornsilk", "cornsilk2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "cornsilk4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("lightpink", "cornsilk2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "cornsilk4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("beige", "cornsilk2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "cornsilk4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("beige", "bisque"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "bisque4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("beige", "bisque"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "bisque3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("beige", "bisque"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "bisque3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("beige", "bisque2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "bisque3", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("bisque", "bisque2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
base_size =6
my_table  <- ggtexttable(temp, rows = NULL,
theme = ttheme('mBlue',
base_size = base_size,
padding = unit(c(1.7, 1.7), "mm"),
colnames.style = colnames_style(size = base_size, fill = "bisque4", color = "white"),
rownames.style = rownames_style(size = base_size),
tbody.style = tbody_style(size = base_size, fill = c("bisque", "bisque2"))
))
HTMP <- ggarrange(heatmap_ggploted, my_table, ncol = 2, widths = c(1,.7), labels = c("a","e"))
HTMP
panel_MASKED <-  ggarrange(HTMP, enrich_panel, heights = c(1,.4) , ncol = 1)
panel_MASKED
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/panel_MASKED.png", panel_MASKED, height = 12, width = 14, dpi = 200, bg = "white")
setwd("/DeepenData/Repos/geometric_cobra")
setwd("/DeepenData/Repos/geometric_cobra")
ggsave("./results/figures/panel_MASKED.png", panel_MASKED, height = 12, width = 15, dpi = 200, bg = "white")
